â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘           INSTALACIÃ“N DEL SISTEMA DE AUTENTICACIÃ“N - GUÃA RÃPIDA          â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

================================================================================
PASO 1: INICIALIZAR DATOS
================================================================================

Ejecuta el comando para crear perfiles, roles y superusuario:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ python manage.py init_auth_data                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Esto crearÃ¡:
  âœ“ 10 Perfiles (Dashboard, MÃ³viles, Equipos, etc.)
  âœ“ 3 Roles (Superadmin, Supervisor, Operador)
  âœ“ Permisos de entidad
  âœ“ 1 Superusuario (admin)

================================================================================
PASO 2: REINICIAR SERVIDOR
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ python manage.py runserver                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
PASO 3: ACCEDER AL SISTEMA
================================================================================

Abre tu navegador y ve a:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ http://127.0.0.1:8000/                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

SerÃ¡s redirigido a la pÃ¡gina de login.

================================================================================
PASO 4: INICIAR SESIÃ“N
================================================================================

Usa las credenciales del superusuario:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Username: admin                                              â”‚
â”‚ Password: admin123                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
PASO 5: Â¡LISTO!
================================================================================

SerÃ¡s redirigido al Dashboard de mÃ³viles con:
  âœ“ Acceso completo a todas las funcionalidades
  âœ“ Ver mÃ³viles, crear, editar, eliminar
  âœ“ Acceso a todos los mapas y reportes
  âœ“ InformaciÃ³n de usuario en sidebar
  âœ“ BotÃ³n "Cerrar SesiÃ³n"

================================================================================
VERIFICACIÃ“N
================================================================================

CHECKLIST:
â–¡ Comando init_auth_data ejecutado sin errores
â–¡ Mensaje "Superusuario creado exitosamente"
â–¡ Servidor corriendo en http://127.0.0.1:8000
â–¡ PÃ¡gina de login se carga correctamente
â–¡ Login con admin/admin123 funciona
â–¡ Redirige a /moviles/
â–¡ Se muestra nombre de usuario en sidebar
â–¡ BotÃ³n "Cerrar SesiÃ³n" funciona

================================================================================
SOLUCIÃ“N DE PROBLEMAS
================================================================================

PROBLEMA: Comando init_auth_data no existe
SOLUCIÃ“N:
  1. Verifica que authentication estÃ© en INSTALLED_APPS
  2. Verifica carpeta: authentication/management/commands/
  3. Verifica archivos __init__.py existan
  4. Reinicia servidor

PROBLEMA: Error al ejecutar init_auth_data
SOLUCIÃ“N:
  1. Verifica que las migraciones estÃ©n aplicadas
  2. python manage.py migrate authentication
  3. Revisa error especÃ­fico en output

PROBLEMA: Login no funciona (credenciales invÃ¡lidas)
SOLUCIÃ“N:
  1. Verifica que el superusuario se creÃ³
  2. python manage.py shell
  3. from django.contrib.auth.models import User
  4. User.objects.filter(is_superuser=True)
  5. Si no existe, crÃ©alo: python manage.py createsuperuser

PROBLEMA: No redirige despuÃ©s de login
SOLUCIÃ“N:
  1. Abre consola del navegador (F12)
  2. Busca errores JavaScript
  3. Verifica que auth.js se cargue correctamente
  4. Verifica CORS configurado

PROBLEMA: "Token invÃ¡lido" o "Usuario no autenticado"
SOLUCIÃ“N:
  1. Limpia localStorage: localStorage.clear()
  2. Vuelve a hacer login
  3. Verifica que el token se guarde correctamente

================================================================================
CREAR USUARIOS ADICIONALES
================================================================================

MÃ‰TODO 1 - Admin Django:

1. http://127.0.0.1:8000/admin/
2. Login con admin/admin123
3. Users -> Add User
4. Username + Password
5. En inline "Perfil de Usuario":
   - Selecciona Rol (Supervisor u Operador)
6. Save

MÃ‰TODO 2 - Shell:

```
python manage.py shell

from django.contrib.auth.models import User
from authentication.models import Rol

# Crear usuario
user = User.objects.create_user(
    username='supervisor1',
    email='supervisor@waygps.com',
    password='super123',
    first_name='Carlos',
    last_name='Supervisor'
)

# Asignar rol
rol = Rol.objects.get(codigo='supervisor')
user.perfil_usuario.rol = rol
user.perfil_usuario.save()
```

================================================================================
CAMBIAR CONTRASEÃ‘A
================================================================================

OPCIÃ“N 1 - Admin Django:
  1. http://127.0.0.1:8000/admin/
  2. Users -> admin -> Change password

OPCIÃ“N 2 - API:
  POST /api/auth/cambiar-password/
  Headers: Authorization: Token <token>
  Body: {
      "password_actual": "admin123",
      "password_nueva": "nueva_password",
      "password_nueva_confirm": "nueva_password"
  }

OPCIÃ“N 3 - Shell:
  ```
  from django.contrib.auth.models import User
  user = User.objects.get(username='admin')
  user.set_password('nueva_password')
  user.save()
  ```

================================================================================
TESTING RÃPIDO
================================================================================

1. PROBAR LOGIN:
   http://127.0.0.1:8000/login/
   admin / admin123

2. VERIFICAR REDIRECCION:
   Debe ir a /moviles/

3. VERIFICAR DATOS DE USUARIO:
   - Nombre visible en sidebar
   - Email visible

4. PROBAR LOGOUT:
   - Clic en "Cerrar SesiÃ³n"
   - Debe redirigir a /login/

5. PROBAR SIN AUTENTICACIÃ“N:
   - Limpia cookies y storage
   - Intenta ir a /moviles/
   - Debe redirigir a /login/

================================================================================
COMANDOS DE REFERENCIA
================================================================================

# Inicializar datos (perfiles, roles, superusuario)
python manage.py init_auth_data

# Crear superusuario adicional
python manage.py createsuperuser

# Ver usuarios
python manage.py shell
>>> from django.contrib.auth.models import User
>>> User.objects.all()

# Ver roles
>>> from authentication.models import Rol
>>> Rol.objects.all()

# Ver perfiles de un usuario
>>> user = User.objects.get(username='admin')
>>> user.perfil_usuario.rol.perfiles.all()

# Ver permisos de un usuario
>>> user.perfil_usuario.rol.permisos_entidad.all()

================================================================================
PRÃ“XIMOS PASOS
================================================================================

DespuÃ©s de instalar y probar:

1. â–¡ Cambiar contraseÃ±a del admin
2. â–¡ Crear usuarios especÃ­ficos para cada persona
3. â–¡ Probar con roles diferentes (supervisor, operador)
4. â–¡ Verificar permisos en el frontend
5. â–¡ Implementar verificaciÃ³n de permisos en vistas
6. â–¡ Agregar 2FA (futuro)
7. â–¡ Implementar multi-empresa (futuro)

================================================================================

âœ… Sistema de autenticaciÃ³n instalado y funcionando!

ğŸš€ PrÃ³ximo comando: python manage.py init_auth_data
ğŸŒ Luego accede a: http://127.0.0.1:8000/
ğŸ” Login: admin / admin123

================================================================================
